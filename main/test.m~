%% Read the new processed file and output the data and target
imgDataPath_processed = '/Users/yuxuan/Desktop/INT301_Assessment2/ass2_processed_data/';
fig1 = imread('/Users/yuxuan/Desktop/INT301_Assessment2/ass2_processed_data/A1.jpeg')
fig2 = imread('/Users/yuxuan/Desktop/INT301_Assessment2/ass2_processed_data/A2.jpeg')
data = [fig1(:), fig2(:)]
%%
% imds = imageDatastore(imgDataPath_processed,);
%%
F = '/Users/yuxuan/Desktop/INT301_Assessment2/ass2data'
imds = imageDatastore(F,'IncludeSubfolders',true,'LabelSource','foldernames')

%%
figure;                              %打开figure界面
perm = randperm(1000,20);           %从1-1000中任取20个数
for i = 1:20
    subplot(4,5,i);                  %将figure界面分割为4X5个小格，并选中第i个小格
    imshow(imds.Files{perm(i)});     %在第i个小格上显示标号为i的图片
end

%%
labelCount = countEachLabel(imds);   %统计imds中各标签值的图片数
labelCount

%%
numTrainFiles = 1920;
[imdsTrain, imdsTest] = splitEachLabel(imds, numTrainFiles,'randomize');
%% split data into 8:2

rng(1)
[ndata, D] = size(X_trans);        %ndata，D: feature dimension
R = randperm(ndata);         %1到n randomize the number as index
num_test = floor(ndata*0.2);
X_test = X_trans(R(1:num_test),:);  
R(1:num_test) = [];
X_train = X_trans(R,:);          
num_training = size(X_train,1);

y_test = y_trans(R(1:num_test),:);
y_train = y_trans(R,:);

%% Assign the new value
data_tr = X_train';
target_tr = y_train';
data_ts = X_test';
target_ts = y_test';

%%
% target_ts;
sample1 = target_ts(:,1)
